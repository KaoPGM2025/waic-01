<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial MetaAi 10.0 - v72.0.0</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Kanit', sans-serif;
            font-size: 17px; /* ‡∏Ç‡∏ô‡∏≤‡∏î‡∏Å‡∏•‡∏≤‡∏á‡πÜ ‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏Ç‡∏≠ */
            background-color: #f0f2f5;
        }
        .card {
            background: white;
            border-radius: 1rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
        }
        .btn-animate {
            transition: transform 0.2s;
        }
        .btn-animate:active {
            transform: scale(0.95);
        }
        .timer-badge {
            font-size: 0.75rem;
            background: #fee2e2;
            color: #ef4444;
            padding: 2px 8px;
            border-radius: 999px;
            font-weight: bold;
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-5xl mx-auto space-y-6">
        <!-- Header -->
        <header class="flex flex-col md:flex-row justify-between items-center bg-blue-600 text-white p-6 rounded-2xl shadow-lg">
            <div class="text-center md:text-left">
                <h1 class="text-2xl font-bold">Financial MetaAi 10.0 <span class="text-sm font-normal opacity-80">v72.0.0</span></h1>
                <p class="text-blue-100">‡∏£‡∏∞‡∏ö‡∏ö‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</p>
            </div>
            <div class="mt-4 md:mt-0 text-center">
                <div class="text-sm opacity-80">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô</div>
                <div id="financialStatus" class="text-xl font-bold italic">- ‡∏£‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -</div>
            </div>
        </header>

        <!-- Summary Widgets -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <div class="card border-l-4 border-green-500">
                <div class="text-gray-500 text-sm">‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</div>
                <div id="totalBalance" class="text-3xl font-bold text-gray-800">0.00 ‡∏ø</div>
            </div>
            <div class="card border-l-4 border-blue-500">
                <div class="text-gray-500 text-sm">‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ (Progress %)</div>
                <div id="goalProgress" class="text-3xl font-bold text-blue-600">0%</div>
                <div class="w-full bg-gray-200 rounded-full h-2 mt-2">
                    <div id="goalBar" class="bg-blue-600 h-2 rounded-full transition-all duration-500" style="width: 0%"></div>
                </div>
            </div>
            <div class="card border-l-4 border-purple-500">
                <div class="text-gray-500 text-sm">‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÇ‡∏î‡∏¢ MetaAi</div>
                <div id="aiSummary" class="text-sm mt-1 text-gray-600 italic">"‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• AI ‡∏à‡∏∂‡∏á‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå"</div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- Form & Graph Column -->
            <div class="space-y-6">
                <!-- Add Transaction Form -->
                <div class="card">
                    <h2 class="text-lg font-semibold mb-4 flex items-center gap-2">
                        <span>üìù ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ò‡∏∏‡∏£‡∏Å‡∏£‡∏£‡∏°</span>
                    </h2>
                    <form id="financeForm" class="space-y-4">
                        <div>
                            <label class="block text-sm text-gray-600">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</label>
                            <input type="text" id="desc" required class="w-full p-2 border rounded-lg outline-none focus:ring-2 focus:ring-blue-400" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô, ‡∏Ñ‡πà‡∏≤‡∏≠‡∏≤‡∏´‡∏≤‡∏£">
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm text-gray-600">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</label>
                                <input type="number" id="amount" required class="w-full p-2 border rounded-lg outline-none focus:ring-2 focus:ring-blue-400" placeholder="0.00">
                            </div>
                            <div>
                                <label class="block text-sm text-gray-600">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</label>
                                <select id="type" class="w-full p-2 border rounded-lg">
                                    <option value="income">‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö (+)</option>
                                    <option value="expense">‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢ (-)</option>
                                </select>
                            </div>
                        </div>
                        <button type="submit" class="w-full bg-blue-600 text-white py-3 rounded-lg font-semibold btn-animate hover:bg-blue-700">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
                    </form>
                </div>

                <!-- Analysis Graph -->
                <div class="card">
                    <h2 class="text-lg font-semibold mb-4">üìä ‡∏Å‡∏£‡∏≤‡∏ü‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô</h2>
                    <div style="height: 250px;">
                        <canvas id="financeChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Transaction History Column -->
            <div class="card flex flex-col h-full">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-lg font-semibold">üïí ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î (‡∏•‡∏ö‡πÉ‡∏ô 1 ‡∏ô‡∏≤‡∏ó‡∏µ)</h2>
                    <span class="text-xs text-gray-400">*‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏•‡∏±‡∏Å‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡πÄ‡∏™‡∏°‡∏≠</span>
                </div>
                <div id="recentList" class="space-y-3 flex-grow overflow-y-auto max-h-[500px]">
                    <!-- Items appear here -->
                    <div class="text-center py-10 text-gray-400">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // State Management
        let masterData = {
            transactions: [],
            balance: 0,
            goal: 50000, // ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
            incomeTotal: 0,
            expenseTotal: 0
        };

        let recentItems = []; // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ô‡∏±‡∏ö‡∏ñ‡∏≠‡∏¢‡∏´‡∏•‡∏±‡∏á 1 ‡∏ô‡∏≤‡∏ó‡∏µ
        let myChart = null;

        const form = document.getElementById('financeForm');
        const recentList = document.getElementById('recentList');
        const balanceDisplay = document.getElementById('totalBalance');
        const goalDisplay = document.getElementById('goalProgress');
        const goalBar = document.getElementById('goalBar');
        const statusDisplay = document.getElementById('financialStatus');
        const aiSummary = document.getElementById('aiSummary');

        // Initialize Chart
        function initChart() {
            const ctx = document.getElementById('financeChart').getContext('2d');
            myChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö', '‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢'],
                    datasets: [{
                        data: [0, 0],
                        backgroundColor: ['#10b981', '#f43f5e'],
                        borderWidth: 0
                    }]
                },
                options: {
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom' }
                    }
                }
            });
        }

        // Add Transaction
        form.addEventListener('submit', (e) => {
            e.preventDefault();
            const desc = document.getElementById('desc').value;
            const amount = parseFloat(document.getElementById('amount').value);
            const type = document.getElementById('type').value;
            const now = Date.now();

            const item = { id: now, desc, amount, type, timestamp: now, expiry: now + 60000 };

            // 1. Save to Master (Never Deleted)
            masterData.transactions.push(item);
            if(type === 'income') {
                masterData.balance += amount;
                masterData.incomeTotal += amount;
            } else {
                masterData.balance -= amount;
                masterData.expenseTotal += amount;
            }

            // 2. Add to Recent (Temporary UI)
            recentItems.unshift(item);

            // 3. Update UI
            updateDashboard();
            renderRecent();
            form.reset();
        });

        function updateDashboard() {
            // Update Balance
            balanceDisplay.innerText = masterData.balance.toLocaleString() + ' ‡∏ø';
            
            // Update Goal %
            const progress = Math.min((masterData.balance / masterData.goal) * 100, 100).toFixed(1);
            goalDisplay.innerText = progress + '%';
            goalBar.style.width = progress + '%';

            // Update Chart
            myChart.data.datasets[0].data = [masterData.incomeTotal, masterData.expenseTotal];
            myChart.update();

            // AI & Status Analysis
            analyzeFinancialStatus();
        }

        function analyzeFinancialStatus() {
            if (masterData.transactions.length === 0) return;

            // 1. Financial Status Label
            let status = "";
            let color = "";
            const ratio = masterData.expenseTotal / masterData.incomeTotal;

            if (masterData.balance < 0) {
                status = "‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏°‡∏≤‡∏Å (‡∏ï‡∏¥‡∏î‡∏•‡∏ö)";
                color = "text-red-600";
            } else if (ratio > 0.8) {
                status = "‡∏Ñ‡∏ß‡∏£‡∏£‡∏∞‡∏°‡∏±‡∏î‡∏£‡∏∞‡∏ß‡∏±‡∏á";
                color = "text-orange-500";
            } else {
                status = "‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏î‡∏µ";
                color = "text-green-600";
            }
            statusDisplay.innerText = status;
            statusDisplay.className = `text-xl font-bold italic ${color}`;

            // 2. AI Detailed Analysis
            let aiText = "";
            if (masterData.incomeTotal === 0 && masterData.expenseTotal > 0) {
                aiText = "MetaAi ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå: ‡∏Ñ‡∏∏‡∏ì‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏ä‡πâ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏Å‡πá‡∏ö‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤ ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡∏´‡∏≤‡πÅ‡∏´‡∏•‡πà‡∏á‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏™‡∏£‡∏¥‡∏°";
            } else if (ratio < 0.3) {
                aiText = "MetaAi ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå: ‡∏¢‡∏≠‡∏î‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°! ‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏≠‡∏°‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 70% ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡∏ô‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏õ‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏á‡∏Ñ‡∏±‡πà‡∏á";
            } else if (ratio > 0.9) {
                aiText = "MetaAi ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå: ‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏Å‡∏∑‡∏≠‡∏ö‡πÄ‡∏ó‡πà‡∏≤‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö! ‡∏•‡∏≠‡∏á‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏ß‡πà‡∏≤‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏î‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô";
            } else {
                aiText = "MetaAi ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå: ‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô ‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏î‡∏∏‡∏•‡∏¢‡∏û‡∏¥‡∏ô‡∏¥‡∏à‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏ä‡πà‡∏ô‡∏ô‡∏µ‡πâ‡∏ï‡πà‡∏≠‡πÑ‡∏õ";
            }
            aiSummary.innerText = `"${aiText}"`;
        }

        function renderRecent() {
            if (recentItems.length === 0) {
                recentList.innerHTML = '<div class="text-center py-10 text-gray-400">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</div>';
                return;
            }

            recentList.innerHTML = recentItems.map(item => `
                <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg border border-gray-100 shadow-sm animate-fade-in">
                    <div>
                        <div class="font-medium text-gray-800">${item.desc}</div>
                        <div class="text-xs text-gray-500">${new Date(item.timestamp).toLocaleTimeString()}</div>
                    </div>
                    <div class="text-right">
                        <div class="font-bold ${item.type === 'income' ? 'text-green-600' : 'text-red-500'}">
                            ${item.type === 'income' ? '+' : '-'}${item.amount.toLocaleString()}
                        </div>
                        <span class="timer-badge" id="timer-${item.id}">...</span>
                    </div>
                </div>
            `).join('');
        }

        // Countdown Timer Logic
        setInterval(() => {
            const now = Date.now();
            let changed = false;

            recentItems = recentItems.filter(item => {
                const timeLeft = Math.round((item.expiry - now) / 1000);
                const timerEl = document.getElementById(`timer-${item.id}`);
                
                if (timeLeft <= 0) {
                    changed = true;
                    return false; // Remove from recent
                }
                
                if (timerEl) {
                    timerEl.innerText = timeLeft + 's';
                }
                return true;
            });

            if (changed) renderRecent();
        }, 1000);

        // On Load
        window.onload = () => {
            initChart();
        };
    </script>

</body>
</html>
